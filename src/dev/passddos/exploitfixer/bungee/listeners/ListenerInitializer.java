package dev._2lstudios.exploitfixer.bungee.listeners;

import dev._2lstudios.exploitfixer.bungee.managers.ModuleManager;
import net.md_5.bungee.api.ProxyServer;
import net.md_5.bungee.api.plugin.Plugin;
import net.md_5.bungee.api.plugin.PluginManager;

public class ListenerInitializer {
    private final Plugin plugin;
    private final ModuleManager moduleManager;
    private boolean registered = false;

    public ListenerInitializer(final Plugin plugin, final ModuleManager moduleManager) {
        this.plugin = plugin;
        this.moduleManager = moduleManager;
    }

    public void register() {
        this.registered = true;

        final ProxyServer server = this.plugin.getProxy();
        final PluginManager pluginManager = server.getPluginManager();

        pluginManager.registerListener(plugin, new ChatListener(plugin, moduleManager));
        pluginManager.registerListener(plugin, new DisconnectListener(moduleManager));
        pluginManager.registerListener(plugin, new PluginMessageListener(moduleManager));
        pluginManager.registerListener(plugin, new PostLoginListener(plugin, moduleManager));
    }

    public void unregister() {
        final ProxyServer server = this.plugin.getProxy();
        final PluginManager pluginManager = server.getPluginManager();

        this.registered = false;

        pluginManager.unregisterListeners(plugin);
    }

    public boolean isRegistered() {
        return this.registered;
    }
}
