package dev._2lstudios.exploitfixer.shared.exploit;

import java.util.Collection;
import java.util.HashMap;
import java.util.Map;

import dev._2lstudios.exploitfixer.shared.configuration.IConfiguration;

public class Violations {
	private Map<Integer, Collection<String>> violations = new HashMap<>();

	public Violations(final IConfiguration configuration) {
		if (configuration != null) {
			for (final String key : configuration.getKeys()) {
				try {
					this.violations.put(Integer.parseInt(key), configuration.getStringList(key));
				} catch (final NumberFormatException ignored) {
				}
			}
		}
	}

	public Collection<String> getCommands(final int violations) {
		return this.violations.getOrDefault(violations, null);
	}

	public Collection<Integer> getViolations() {
		return violations.keySet();
	}
}
